# Maven
# Build your Java project and run tests with Apache Maven.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/java

trigger:
- master

pool:
  vmImage: 'ubuntu-latest'

variables:
  # Nom du projet et du package
  projectName: 'devops-project'
  artifactName: 'devops-project-build.zip'
  artifactPath: '$(Build.ArtifactStagingDirectory)/$(artifactName)'

stages:
- stage: Build
  jobs:
  - job: BuildAndPackage
    steps:
    # Étape 1 : Installer Amazon Corretto 8 (Java 8)
    - script: |
        # Télécharger et installer Amazon Corretto 8 (Java 8)
        wget https://corretto.aws/downloads/latest/amazon-corretto-8-x64-linux-jdk.deb
        sudo dpkg -i amazon-corretto-8-x64-linux-jdk.deb
        sudo apt-get update
        sudo apt-get install -f
        java -version  # Vérification de l'installation de Java
      displayName: 'Install Amazon Corretto 8'

    # Étape 2 : Configurer JAVA_HOME pour Maven
    - script: |
        # Configurer JAVA_HOME pour Maven
        export JAVA_HOME=/usr/lib/jvm/java-8-amazon-corretto
        export PATH=$JAVA_HOME/bin:$PATH
        java -version  # Vérification de l'environnement Java
      displayName: 'Set JAVA_HOME for Maven'

    